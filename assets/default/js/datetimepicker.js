!function(a){"use strict";function t(a){return moment(a.toDate())}function d(a){return 12*a.format("YYYY")+parseInt(a.format("MM"))}a.fn.dateTimePicker=function(e){var n=a.extend({selectData:"now",dateFormat:"YYYY-MM-DD HH:mm",showTime:!0,locale:"en",positionShift:{top:20,left:0},title:"Select Date and Time",buttonTitle:"Select"},e);moment.locale(n.locale);var i=this,o={hour:23,minute:59},l=!1,s=800,r="now"==n.selectData?moment():moment(n.selectData,n.dateFormat);r<moment()&&(r=moment());var p=t(moment()),m=t(r);return this.each(function(){m!=r&&(r=t(m)),i.addClass("dtp_main"),function(){var t=n.dateFormat.split(" ");n.showTime&&2!=t.length&&(t.length=2,t[0]="DD/MM/YY",t[1]="HH:mm");var d=a("<span>");d.text(m.format(t[0])),i.empty(),i.append(d),(d=a("<i>")).addClass("fa fa-calendar ico-size"),i.append(d),n.showTime&&((d=a("<span>")).text(m.format(t[1])),i.append(d),(d=a("<i>")).addClass("fa fa-clock-o ico-size"),i.append(d))}(),i.on("click",function(){var e=a("<div>");e.addClass("dtp_modal-win");var c=a("body");c.append(e);var f=function(){var t=a("<div>");n.showTime?t.addClass("dtp_modal-content"):t.addClass("dtp_modal-content-no-time");var d=a("<div>");if(d.addClass("dtp_modal-title"),d.text(n.title),t.append(d),(d=a("<div>")).addClass("dtp_modal-cell-date"),d.attr("id","field-data"),t.append(d),n.showTime){(d=a("<div>")).addClass("dtp_modal-cell-time");var e=a("<div>");e.addClass("dtp_modal-time-block"),e.attr("id","field-time"),d.append(e);var i=a("<div>");i.attr("id","time-line"),i.addClass("dtp_modal-time-line"),i.text(m.format(n.dateFormat)),e.append(i),e.append(function(){var t=a("<div>");t.addClass("dtp_modal-time-mechanic");var d=a("<div>");d.addClass("dtp_modal-append");var e=a("<i>");e.attr("id","angle-up-hour"),e.addClass("fa fa-angle-up ico-size-large cursorily hov"),d.append(e);var n=a("<span>");n.addClass("dtp_modal-midle"),d.append(n),(e=a("<i>")).attr("id","angle-up-minute"),e.addClass("fa fa-angle-up ico-size-large cursorily hov"),d.append(e),t.append(d),(d=a("<div>")).addClass("dtp_modal-digits");var i=a("<span>");return i.addClass("dtp_modal-digit"),i.attr("id","d-hh"),i.text(m.format("HH")),d.append(i),(n=a("<span>")).addClass("dtp_modal-midle-dig"),n.html(":"),d.append(n),(i=a("<span>")).addClass("dtp_modal-digit"),i.attr("id","d-mm"),i.text(m.format("mm")),d.append(i),t.append(d),(d=a("<div>")).addClass("dtp_modal-append"),(e=a("<i>")).attr("id","angle-down-hour"),e.addClass("fa fa-angle-down ico-size-large cursorily hov"),d.append(e),(n=a("<span>")).addClass("dtp_modal-midle"),d.append(n),(e=a("<i>")).attr("id","angle-down-minute"),e.addClass("fa fa-angle-down ico-size-large cursorily hov"),d.append(e),t.append(d),t}());var o=a("<div>");o.addClass("dpt_modal-button"),o.text(n.buttonTitle),o.bind("click",w),d.append(o),t.append(d)}return t}();c.append(f);var v,u=i.offset();if(f.css({top:u.top+n.positionShift.top+"px",left:u.left+n.positionShift.left+"px"}),g(r),e.on("click",function(){f.remove(),e.remove()}),n.showTime){(v=a(f).find('i[id^="angle-"]')).bind("mouseup",function(){l=!1,s=800}),v.bind("mousedown",function(){l=!0,Y(this)});var h=a("#field-time"),C=h.find("#d-hh"),_=h.find("#d-mm")}function g(e){var n=f.find("#field-data");n.empty(),n.append(function(t){var d=a("<div>");d.addClass("dtp_modal-months");var e=a("<i></i>");return e.addClass("fa fa-angle-left cursorily ico-size-month hov"),e.bind("click",T),d.append(e),(e=a("<span>")).text(t.format("MMMM YYYY")),d.append(e),(e=a("<i></i>")).addClass("fa fa-angle-right cursorily ico-size-month hov"),e.bind("click",y),d.append(e),d}(e)),n.append(function(e){var n=a("<div>");n.addClass("dtp_modal-calendar");for(var i=0;i<7;i++){var o=a("<div>");o.addClass("dtp_modal-calendar-cell dtp_modal-colored"),o.text(moment().weekday(i).format("ddd")),n.append(o)}var l=t(e);l.date(1);for(var s=d(e)===d(p),r=d(m)===d(e),c=parseInt(e.format("D")),f=parseInt(p.format("D")),i=0;i<6;i++)for(var v=0;v<7;v++){var u=a("<div>");if(u.html("&nbsp;"),u.addClass("dtp_modal-calendar-cell"),l.month()==e.month()&&l.weekday()==v){var h=parseInt(l.format("D"));u.text(h),s&&h<f?u.addClass("dtp_modal-grey"):r&&h==c?u.addClass("dtp_modal-cell-selected"):(u.addClass("cursorily"),u.bind("click",x)),l.add(1,"days")}n.append(u)}return n}(e))}function x(){var d=a(this);r.date(d.text()),m=t(r),b();var e=f.find("#field-data").find(".dtp_modal-cell-selected");e.removeClass("dtp_modal-cell-selected"),e.addClass("cursorily"),d.addClass("dtp_modal-cell-selected"),d.removeClass("cursorily"),e.bind("click",x),d.unbind("click")}function w(){n.showTime&&(m.hour(parseInt(C.text())),m.minute(parseInt(_.text())),r.hour(parseInt(C.text())),r.minute(parseInt(_.text()))),b(),f.remove(),e.remove()}function y(){r.add(1,"month"),g(r)}function T(){d(r)>d(p)&&(r.add(-1,"month"),g(r))}function Y(t){var d=this||t,e=(d=a(d)).attr("id").split("-"),n=1;"down"==e[1]&&(n=-1),function(a,t){var d="hour"==a?C:_,e=parseInt(d.text())+t;e<0?e=o[a]:e>o[a]&&(e=0);d.text(function(a){if(a<10)return"0"+a;return a}(e))}(e[2],n),setTimeout(function(){var a;a=d,l&&(s>200&&(s-=200),Y(a))},s)}function b(){n.showTime&&a("#time-line").text(m.format(n.dateFormat)),function(){var t=n.dateFormat.split(" ");n.showTime&&2!=t.length&&(t.length=2,t[0]="DD/MM/YY",t[1]="HH:mm");var d=a("<span>");d.text(m.format(t[0])),i.empty(),i.append(d),(d=a("<i>")).addClass("fa fa-calendar ico-size"),i.append(d),n.showTime&&((d=a("<span>")).text(m.format(t[1])),i.append(d),(d=a("<i>")).addClass("fa fa-clock-o ico-size"),i.append(d))}(),i.next().val(r.format(n.dateFormat)),n.showTime||(f.remove(),e.remove())}})})}}(jQuery);